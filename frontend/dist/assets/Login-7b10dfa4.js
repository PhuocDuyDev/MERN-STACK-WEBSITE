import{u as A,r as t,J as H,t as j,K as k,j as a,b as l,L as F,M as B}from"./index-26733e41.js";import{v as d}from"./index-69ff641d.js";import{b as D}from"./toast-99f67b36.js";const G="_option_1d780_149",n={"login-page":"_login-page_1d780_1","form-input":"_form-input_1d780_89","error-server":"_error-server_1d780_135",option:G},U=()=>{const{setIsAuthenticated:h,isAuthenticated:u,setCurrentUser:c}=A(),[i,f]=t.useState(""),[o,v]=t.useState(""),{mutate:E,data:s,error:r,loading:m}=H(),[p,w]=t.useState(null),[y,P]=t.useState(null),[_,S]=t.useState(null),[b,I]=t.useState(!1),N=j();t.useEffect(()=>{if(u&&(D("You already logged in! Shopping now"),N("/products")),s&&!r){const{accessToken:e}=s==null?void 0:s.login.authPayload;c(s==null?void 0:s.login.authPayload.user),k.setToken(e),h(!0)}r&&w(r.message)},[s,r,u]),t.useEffect(()=>{const e=setTimeout(()=>{I(d.isEmail(i)&&d.isLength(o.trim(),{min:6}))},300);return()=>{clearTimeout(e)}});const T=async e=>{var g;e.preventDefault();const x=await E({variables:{email:i,password:o}});c((g=x.data)==null?void 0:g.login.authPayload.user)},C=e=>{f(e.target.value)},L=e=>{v(e.target.value)},M=()=>{P(d.isEmail(i))},V=()=>{S(d.isLength(o.trim(),{min:6}))};return a("div",{className:n["login-page"],children:l("form",{method:"post",className:n.form,onSubmit:T,children:[l("div",{className:n["form-input"],children:[a("label",{htmlFor:"inputEmail",children:"Email: "}),a("input",{id:"inputEmail",type:"email",value:i,name:"email",onChange:C,onBlur:M,placeholder:"Enter your email..."}),y===!1?a("span",{children:"Email is invalid. Please try again!"}):null]}),l("div",{className:n["form-input"],children:[a("label",{htmlFor:"inputPassword",children:"Password: "}),a("input",{id:"inputPassword",type:"password",value:o,name:"password",onChange:L,onBlur:V,placeholder:"Enter your password..."}),_===!1?a("span",{children:"Password is invalid. Please try again!"}):null]}),p?a("span",{className:n["error-server"],children:p}):null,l("div",{className:n.option,children:[a("p",{children:"Don't have an account?"}),a(F,{to:B,children:"Signup now!"})]}),a("button",{disabled:!b||m,type:"submit",children:m?"Try log in":"Submit"})]})})};export{U as default};
