import{u as D,c as E,Z as x,_ as O,r as m,w as S,$ as M,j as t,S as Q,a as c,F as P,L as z,P as j}from"./index-e09b3632.js";import{a as B,n as C}from"./toast-1c021ce3.js";import{m as G,p as L}from"./plus-9f102ee5.js";import{S as F}from"./SliderImages-5145811e.js";const R="_breadcrumb_15wrl_1",U="_active_15wrl_201",e={breadcrumb:R,"product-container":"_product-container_15wrl_25","product-details":"_product-details_15wrl_37","product-details-title":"_product-details-title_15wrl_51","product-details-price":"_product-details-price_15wrl_71","product-details-price-sale":"_product-details-price-sale_15wrl_85","product-details-price-original":"_product-details-price-original_15wrl_99","not-sale":"_not-sale_15wrl_115","product-details-size":"_product-details-size_15wrl_133","size-quantity":"_size-quantity_15wrl_145","size-list":"_size-list_15wrl_163","btn-size":"_btn-size_15wrl_171","btn-quantity":"_btn-quantity_15wrl_173","btn-close":"_btn-close_15wrl_175",active:U,"product-details-quantity":"_product-details-quantity_15wrl_245","product-details-quantity-input":"_product-details-quantity-input_15wrl_255","btn-add-to-cart":"_btn-add-to-cart_15wrl_273"},W=()=>{const{setCurrentUser:s}=D(),{mutate:f}=E(),{productId:p}=x(),{data:a,loading:l,error:_}=O(p),[i,n]=m.useState(1),[h,b]=m.useState("S");S(),m.useEffect(()=>{const r=new AbortController;return(async()=>{try{await refetch({productId:p},{signal:r.signal})}catch(y){y.name}})(),()=>{r.abort()}},[p]);const d=m.useMemo(()=>a==null?void 0:a.product.size.items.filter(({size:r})=>r===h)[0].quantity,[a,h]),q=m.useCallback(r=>{b(r);const[g]=a==null?void 0:a.product.size.items.filter(({size:y})=>y===r);g.quantity===0?n(0):n(1)},[a]),w=m.useCallback(r=>{r.target.value>d?n(d):n(r.target.value)},[]),o=()=>{i<=1?n(1):n(r=>r-1)},$=()=>{i>=d?n(d):n(r=>r+1)},k=async(r,g)=>{var v,I;r.preventDefault();const{productId:y,quantity:N,size:H,isEditQuantity:T}=g;try{if(+N<=0)throw new Error("Product out of stocks");const u=await f({variables:{inputProduct:{productId:y,quantity:+N,size:H,isEditQuantity:T}}});s(u.data.addToCart),B("Added success product to cart!")}catch(u){if(((I=(v=u==null?void 0:u.extensions)==null?void 0:v.http)==null?void 0:I.status)===401){C("Please login to use this feature!");return}return C(u.message),u}},[A]=M.filter(({category:r})=>r===(a==null?void 0:a.product.category));return{product:a==null?void 0:a.product,loading:l,error:_==null?void 0:_.graphQLErrors[0],categoryBreadcum:A,quantityInput:i,sizeSelect:h,quantityOfSize:d,quantityChangeHandler:w,quantityDecreaseHandler:o,quantityIncreaseHandler:$,sizeChangeHandler:q,handleAddToCart:k}},X=()=>{const{product:s,loading:f,error:p,categoryBreadcum:a,quantityInput:l,sizeSelect:_,quantityOfSize:i,quantityChangeHandler:n,quantityDecreaseHandler:h,quantityIncreaseHandler:b,sizeChangeHandler:d,handleAddToCart:q}=W(),w=S();return f?t(Q,{}):p?(C(p.message),setTimeout(()=>{w("/products ")},2*1e3),t("div",{children:"eror"})):c(P,{children:[c("div",{className:`${e.breadcrumb}`,children:[t(z,{to:"/",children:"Home"}),t("span",{children:" / "}),t(z,{to:j,children:"Products"}),t("span",{children:" / "}),t(z,{to:`/products?category=${s.category}`,children:a.title})]}),t("section",{className:`${e["product-section"]} section`,children:c("div",{className:`container ${e["product-container"]}`,children:[t(F,{productImg:s.images,productName:s.name}),c("div",{className:e["product-details"],children:[t("h3",{className:e["product-details-title"],children:s.name}),c("div",{className:e["product-details-price"],children:[s.discount>0?c("span",{className:e["product-details-price-sale"],children:["$",Math.floor(s.price-Math.round(s.price*s.discount/100))]}):null,c("span",{className:`${e["product-details-price-original"]} ${s.discount?null:e["not-sale"]}`,children:["$",s.price]})]}),c("div",{className:e["product-details-size"],children:[t("p",{className:e["size-quantity"],children:i>0?c(P,{children:[t("span",{children:i})," in stock"]}):t("span",{children:"Out of stocks"})}),t("div",{className:e["size-list"],children:s.size.items.map(({size:o})=>t("button",{onClick:()=>d(o),className:`${e["btn-size"]} ${o===_?e.active:null}`,children:o},o))})]}),c("div",{className:e["product-details-quantity"],children:[t("button",{className:e["btn-quantity"],onClick:h,disabled:i<=1||l<=1,children:t("img",{src:G,alt:"minus icon"})}),t("input",{type:"tel",className:e["product-details-quantity-input"],value:l>=i?i:l,onChange:n}),t("button",{className:e["btn-quantity"],onClick:b,disabled:l>=i,children:t("img",{src:L,alt:"plus icon"})})]}),t("button",{onClick:o=>q(o,{productId:s.id,quantity:+l,size:_,isEditQuantity:!1}),className:e["btn-add-to-cart"],children:"ADD TO CART"})]})]})})]})};export{X as default};
