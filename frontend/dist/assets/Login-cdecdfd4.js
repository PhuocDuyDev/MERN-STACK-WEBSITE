import{u as L,r as t,U as M,w as T,V,W as A,j as e,a as i,I as c,L as H,X as k}from"./index-e09b3632.js";import{v as m}from"./index-cda56c12.js";import{b as z}from"./toast-1c021ce3.js";const B="_option_y0jfw_141",n={"login-page":"_login-page_y0jfw_1","form-input":"_form-input_y0jfw_89","error-server":"_error-server_y0jfw_119",option:B},R=()=>{const{setIsAuthenticated:p,isAuthenticated:u,setCurrentUser:g}=L(),[r,h]=t.useState(""),[l,f]=t.useState(""),{mutate:v,data:a,error:o,loading:w}=M(),[d,y]=t.useState(null),[E,_]=t.useState(null),[P,S]=t.useState(null),I=T();t.useEffect(()=>{if(u&&(z("You already logged in! Shopping now"),I("/products")),a&&!o){const{accessToken:s}=a==null?void 0:a.login.authPayload;g(a==null?void 0:a.login.authPayload.user),V.setToken(s),p(!0),A.resetStore()}o&&y(o.message)},[a,o,u]);const b=async s=>{s.preventDefault(),await v({variables:{email:r,password:l}})},j=s=>{h(s.target.value)},N=s=>{f(s.target.value)},C=()=>{_(m.isEmail(r))},x=()=>{S(m.isLength(l.trim(),{min:6}))};return e("div",{className:n["login-page"],children:i("form",{method:"post",className:n.form,onSubmit:b,children:[i("div",{className:n["form-input"],children:[e("label",{htmlFor:"inputEmail",children:"Email: "}),e(c,{id:"inputEmail",type:"email",value:r,name:"email",onChange:j,onBlur:C,placeholder:"Enter your email...",sizeInput:"small"}),E===!1?e("span",{children:"Email is invalid. Please try again!"}):null]}),i("div",{className:n["form-input"],children:[e("label",{htmlFor:"inputPassword",children:"Password: "}),e(c,{id:"inputPassword",type:"password",value:l,name:"password",onChange:N,onBlur:x,placeholder:"Enter your password...",sizeInput:"small"}),P===!1?e("span",{children:"Password is invalid. Please try again!"}):null]}),d?e("span",{className:n["error-server"],children:d}):null,i("div",{className:n.option,children:[e("p",{children:"Don't have an account?"}),e(H,{to:k,children:"Signup now!"})]}),e("button",{type:"submit",children:w?"Try log in":"Submit"})]})})};export{R as default};
